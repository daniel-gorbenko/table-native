(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,n,t){},12:function(e,n,t){"use strict";t.r(n);var o=t(0),r=t.n(o),a=t(4),u=t.n(a),c=(t(11),t(2)),l=function(e){return r.a.createElement("div",{className:"page-create-table"},r.a.createElement("h1",null,"\u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0442\u0430\u0431\u043b\u0438\u0446\u0443"),r.a.createElement("form",{onSubmit:e.onSubmit},r.a.createElement("input",{onChange:function(n){return e.onChange(n,"rows")},value:e.values.rows,type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a"}),r.a.createElement("input",{onChange:function(n){return e.onChange(n,"cols")},value:e.values.cols,type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u043e\u043b\u0431\u0446\u043e\u0432"}),r.a.createElement("input",{onChange:function(n){return e.onChange(n,"x")},value:e.values.x,type:"number",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e X"}),r.a.createElement("input",{type:"submit",value:"\u041f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c"})))},i=function(e){return r.a.createElement("td",{className:e.className,onClick:e.onClick,onMouseEnter:e.onMouseOver,onMouseLeave:e.onMouseOut},r.a.createElement("span",{className:"amount"},e.value),e.children)},s=function(e){var n=[e.highlight?"highlight":"",e.over?"over":""].join(" "),t={height:"".concat(e.percentValue,"%")};return r.a.createElement(i,{className:n,value:e.value,onClick:e.onClick,onMouseOver:e.onMouseOver,onMouseOut:e.onMouseOut},r.a.createElement("span",{className:"percent_value"},e.percentValue,"%"),r.a.createElement("div",{className:"percent",style:t}))},m=function(e){return r.a.createElement(i,{className:"sum_cell",value:e.value,onMouseOver:e.onMouseOver,onMouseOut:e.onMouseOut},r.a.createElement("span",{onClick:e.onRowRemove,className:"delete_row"},r.a.createElement("span",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c")))},f=function(e){return r.a.createElement("tr",null,e.children)},d=r.a.memo(function(e){return r.a.createElement(i,{value:e.value})}),h=r.a.memo(function(e){return r.a.createElement(f,null,e.cells.map(function(e,n){return r.a.createElement(d,{key:n,value:e})}))}),v=r.a.memo(function(e){return r.a.createElement(s,{percentValue:e.getPercent(e.rowIndex,e.amount),onClick:function(n){return e.onCellClick(n,e.rowIndex,e.colIndex)},onMouseOver:function(n){return e.onCellOver(n,e.rowIndex,e.colIndex)},onMouseOut:function(n){return e.onCellOut(n,e.rowIndex,e.colIndex)},over:e.over,value:e.amount,highlight:e.highlight})}),w=r.a.memo(function(e){return r.a.createElement(m,{onMouseOver:function(n){return e.onSumCellOver(e.index)},onMouseOut:function(n){return e.onSumCellOut(e.index)},onRowRemove:function(n){return e.onRowRemove(n,e.index)},value:e.sumCellValue})}),b=r.a.memo(function(e){return r.a.createElement("tr",null,e.cells.map(function(n,t){return r.a.createElement(v,{key:t,rowIndex:e.index,colIndex:t,getPercent:e.getPercent,onCellClick:e.onCellClick,onCellOver:e.onCellOver,onCellOut:e.onCellOut,over:n.over,amount:n.amount,highlight:n.highlight})}),r.a.createElement(w,{index:e.index,onSumCellOver:e.onSumCellOver,onSumCellOut:e.onSumCellOut,onRowRemove:e.onRowRemove,sumCellValue:e.sumCellValue}))},function(e,n){return!n.reRender}),g=t(1),p=function(e,n){e.current[n]=!0},O=function(e,n){for(var t=n.row,o=n.col,r=n.highlighted,a=n.x,u=n.changedRows,c=e[t][o],l=e.reduce(function(e,n,t){return n.forEach(function(n,o){e.push({row:t,col:o,amountDiff:Math.abs(c.amount-n.amount),cell:n})}),e},[]),i=(l=l.sort(function(e,n){return e.amountDiff<n.amountDiff?-1:e.amountDiff>n.amountDiff?1:e.amountDiff===n.amountDiff?0:void 0})).length,s=0,m=0;s<a&&i!==m;m++)l[m].cell!==c&&(r.current[s]=l[m],p(u,l[m].row),e[l[m].row][l[m].col].highlight=!0,s++);return Object(g.a)(e)},C=function(e,n){for(var t=n.highlighted,o=n.x,r=n.changedRows,a=t.current.length,u=0;u<o&&a!==u;u++)p(r,t.current[u].row),e[t.current[u].row][t.current[u].col].highlight=!1;return t.current=[],Object(g.a)(e)},R=function(e,n){switch(n.type){case"cell-click":return O(C(function(e,n){var t=n.row,o=n.col,r=n.changedRows;return p(r,t),e[t][o].amount+=1,Object(g.a)(e)}(e,n.payload),n.payload),n.payload);case"cell-over":return O(C(e,n.payload),n.payload);case"cell-out":return C(e,n.payload);case"sum-cell-over":return function(e,n){var t=n.row,o=n.changedRows;return p(o,t),e[t].forEach(function(e){e.over=!0}),Object(g.a)(e)}(e,n.payload);case"sum-cell-out":return function(e,n){var t=n.row,o=n.changedRows;return p(o,t),e[t].forEach(function(e){e.over=!1}),Object(g.a)(e)}(e,n.payload);case"row-add":return function(e,n){n.e;var t=n.rowIdList,o=n.nextRowId,r=n.rowData,a=[].concat(Object(g.a)(e),[r]);return t.current[t.current.length]=o,a}(e,n.payload);case"row-remove":return function(e,n){n.e;for(var t=n.row,o=n.rowIdList,r=n.changedRows,a=t,u=e.length;a<u;a++)p(r,a);var c=[].concat(Object(g.a)(e.slice(0,t)),Object(g.a)(e.slice(t+1)));return o.current.splice(t,1),c}(e,n.payload);default:throw new Error("action.type should be exist")}};function E(e){return parseInt(Math.random().toString().substring(2,e))}var x=function(e){var n=e.amountDigits+2,t=Object(o.useRef)([]),a=Object(o.useRef)(-1),u=Object(o.useRef)([]),l=Object(o.useRef)([]),i=Object(o.useRef)(!0),s=Object(o.useRef)(null),m=Object(o.useReducer)(R,null,function(){for(var n=[],o=-1===a.current,r=0;r<e.rows;r++)n[r]=p(r),o&&(a.current=t.current[r]=g());return n}),f=Object(c.a)(m,2),d=f[0],v=f[1];function w(e){i.current=e}function g(){return++a.current}function p(t){for(var o,r,a=[],u=0;u<e.cols;u++)a[u]=(o=u,r=n,{id:"".concat(t,"_").concat(o),amount:E(r)});return a}function O(e,n,t){for(var o=0,r=0;r<t;r++)o+=n[r][e].amount;return o}i.current&&(s.current=function(e,n,t){for(var o=[],r=0;r<n;r++)o[r]=O(r,t,e);return o}(e.rows,e.cols,d)),Object(o.useEffect)(function(){l.current=l.current.map(function(){return!1})}),Object(o.useEffect)(function(){i.current=!1});for(var C,x=Object(o.useCallback)(function(n,t){return(t/function(e,n,t){for(var o=0,r=0;r<t;r++)o+=n[e][r].amount;return o}(n,d,e.cols)*100).toFixed(2)},[e.rows,e.cols]),y=Object(o.useCallback)(function(n){w(!0),v({type:"row-add",payload:{e:n,rowIdList:t,rowData:p(d.length),nextRowId:g()}}),e.onRowAdd(n)},[]),j=Object(o.useCallback)(function(n,o){w(!0),v({type:"row-remove",payload:{e:n,row:o,rowIdList:t,changedRows:l}}),e.onRowRemove(n)},[]),k=Object(o.useCallback)(function(e){v({type:"sum-cell-over",payload:{row:e,changedRows:l}})},[]),I=Object(o.useCallback)(function(e){v({type:"sum-cell-out",payload:{row:e,changedRows:l}})},[]),M=Object(o.useCallback)(function(n,t,o){w(!0),v({type:"cell-click",payload:{row:t,col:o,highlighted:u,x:e.x,changedRows:l}})},[]),S=Object(o.useCallback)(function(n,t,o){v({type:"cell-over",payload:{e:n,row:t,col:o,x:e.x,highlighted:u,changedRows:l}})},[e.x]),D=Object(o.useCallback)(function(n,t,o){v({type:"cell-out",payload:{e:n,row:t,col:o,x:e.x,highlighted:u,changedRows:l}})},[e.x]),N=[],V=0;V<e.rows;V++)N.push(r.a.createElement(b,{index:V,cells:d[V],key:t.current[V],reRender:(C=V,l.current[C]),getPercent:x,onCellClick:M,onCellOver:S,onCellOut:D,onSumCellOver:k,onSumCellOut:I,onRowRemove:j,sumCellValue:d[V].reduce(function(e,n){return e+n.amount},0)}));return r.a.createElement("table",null,r.a.createElement("caption",null,r.a.createElement("h2",null,"\u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430"),r.a.createElement("button",{className:"table-btn",onClick:y},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u0442\u0440\u043e\u043a\u0443")),r.a.createElement("thead",null),r.a.createElement("tbody",null,N),r.a.createElement("tfoot",null,r.a.createElement(h,{cells:s.current})))},y=function(e){return r.a.createElement(x,{cols:e.cols,rows:e.rows,x:e.x,amountDigits:e.amountDigits,onRowAdd:e.onRowAdd,onRowRemove:e.onRowRemove})},j=function(e){var n=Object(o.useState)(""),t=Object(c.a)(n,2),a=t[0],u=t[1],i=Object(o.useState)(""),s=Object(c.a)(i,2),m=s[0],f=s[1],d=Object(o.useState)(""),h=Object(c.a)(d,2),v=h[0],w=h[1],b=Object(o.useState)("CreateTable"),g=Object(c.a)(b,2),p=g[0],O=g[1];switch(p){case"CreateTable":return r.a.createElement(l,{onSubmit:function(e){e.preventDefault(),O("Table")},onChange:function(e,n){switch(n){case"rows":u(parseInt(e.target.value));break;case"cols":f(parseInt(e.target.value));break;case"x":w(parseInt(e.target.value))}},values:{rows:a,cols:m,x:v}});case"Table":return r.a.createElement(y,{rows:a,cols:m,x:v,amountDigits:3,onRowAdd:function(){u(function(e){return e+1})},onRowRemove:function(){u(function(e){return e-1})}})}};u.a.render(r.a.createElement(j,null),document.getElementById("root"))},5:function(e,n,t){e.exports=t(12)}},[[5,1,2]]]);
//# sourceMappingURL=main.fcb9704c.chunk.js.map